<section class="kpis">
  <div class="kpi-card" *ngFor="let kpi of kpis">
    <div class="kpi-row">
      <div class="kpi-left">
        <span class="kpi-ico" aria-hidden="true">{{ kpi.icone }}</span>

        <div class="kpi-text">
          <div class="kpi-label">{{ kpi.titulo }}</div>

          <div class="kpi-value">
            <!-- EDIÇÃO -->
            <div class="kpi-edit" *ngIf="editing[kpi.chave]; else visualizacao">
              <input [(ngModel)]="editValues[kpi.chave]" />
              <button type="button" class="btn" (click)="salvarEdicao(kpi.chave)">Salvar</button>
              <button type="button" class="btn ghost" (click)="cancelarEdicao(kpi.chave)">Cancelar</button>
            </div>

            <!-- VISUALIZAÇÃO -->
            <ng-template #visualizacao>
              <ng-container *ngIf="(visibility.showBalances$ | async); else valorOculto">
                <button
                  *ngIf="podeEditarKpi(kpi.chave); else valorSomenteLeitura"
                  type="button"
                  class="kpi-button"
                  (click)="iniciarEdicao(kpi.chave)"
                >
                  {{ obterValorKpi(kpi.chave) }}
                </button>

                <ng-template #valorSomenteLeitura>
                  <div class="kpi-static">{{ obterValorKpi(kpi.chave) }}</div>
                </ng-template>
              </ng-container>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #valorOculto>••••</ng-template>
</section>

<app-transacoes
  [transactions]="transactions"
  [mostrarAcoesEPaginacao]="false"
  (add)="receberTransacaoFilha($event)">
</app-transacoes>
